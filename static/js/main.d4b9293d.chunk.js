(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{59:function(e,t,n){e.exports=n(80)},64:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n.n(a),o=n(54),c=n.n(o),i=(n(64),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function l(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var s,u,p=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,81)).then(function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),o(e),c(e)})},m=n(16),d=n(34),f=n(38),b=n(55),g=n(1),h=n(10),v=new h.HttpLink({uri:"https://sono-morena.herokuapp.com/graphql"}),w=new b.a({uri:"wss://sono-morena.herokuapp.com/graphql"}),O=Object(h.split)(function(e){var t=e.query,n=Object(g.q)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation},w,v),y=new h.ApolloClient({cache:new h.InMemoryCache,link:h.ApolloLink.from([O])}),j=Object(h.gql)(s||(s=Object(f.a)(["\n    query getSleep {\n      sleeps {\n        time\n        type\n      }\n    }\n  "]))),k=Object(h.gql)(u||(u=Object(f.a)(["\n    subscription Sub {\n      sleepChanged {\n        time\n        type\n      }\n    }\n  "]))),E=Object(h.gql)("\n  mutation  createSleep($time:DateTime!, $type:String!){\n          createSleep(time:$time,  type:$type){\n            type\n            time\n  }}");function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var C=r.a.createElement("g",null,r.a.createElement("path",{d:"M75.4 126.63a11.43 11.43 0 0 1-2.1-22.65 40.9 40.9 0 0 0 30.5-30.6 11.4 11.4 0 1 1 22.27 4.87h.02a63.77 63.77 0 0 1-47.8 48.05v-.02a11.38 11.38 0 0 1-2.93.37z"}),r.a.createElement("animateTransform",{attributeName:"transform",type:"rotate",from:"0 64 64",to:"360 64 64",dur:"500ms",repeatCount:"indefinite"})),D=function(e){var t=e.svgRef,n=N(e,["svgRef"]);return r.a.createElement("svg",S({width:"30px",height:"30px",viewBox:"0 0 128 128",xmlSpace:"preserve",ref:t},n),C)},x=r.a.forwardRef(function(e,t){return r.a.createElement(D,S({svgRef:t},e))});n.p;var A=function(e){e.reduce(function(t,n,a){if(console.log(t),a>0){var r=n.time-e[a-1].time;return"end"===n.type?Object(m.a)(Object(m.a)({},t),{},{asleep:t.asleep+r}):Object(m.a)(Object(m.a)({},t),{},{awake:t.awake+r})}return t},{awake:0,asleep:0})};function q(e){var t=e.getMinutes(),n=e.getHours();return"".concat(n,":").concat(t>9?"":"0").concat(t)}var P=function(){var e=Object(h.useSubscription)(k),t=Object(h.useQuery)(j,{pollInterval:3e4,notifyOnNetworkStatusChange:!0}),n=t.loading,o=(t.error,t.data),c=t.refetch,i=t.networkStatus,l=Object(h.useMutation)(E),s=Object(d.a)(l,2),u=s[0],p=(s[1].slp_data,Object(a.useState)({type:"",last_load:new Date(0)})),f=Object(d.a)(p,2),b=f[0],g=f[1],v=Object(a.useState)(""),w=Object(d.a)(v,2),O=w[0],y=w[1];return Object(a.useEffect)(function(){n||(e.data?g(Object(m.a)(Object(m.a)({},e.data.sleepChanged),{},{last_load:new Date})):o.sleeps&&(g(Object(m.a)(Object(m.a)({},o.sleeps[o.sleeps.length-1]),{},{last_load:new Date})),console.log(A(o.sleeps))))},[o,e.data]),r.a.createElement(r.a.Fragment,null,""===b.type?r.a.createElement("div",{className:"container container-blue"},r.a.createElement(x,null)):r.a.createElement("div",{className:"".concat("start"===b.type?"container-blue":"container-green"," container")},r.a.createElement("h1",null," ","Morena est\xe1 ","start"===b.type?"dormindo":"acordada"),r.a.createElement("h3",null," desde as ",q(new Date(b.time))),r.a.createElement("div",{className:"button-grid"},r.a.createElement("div",{className:"set-time-flex ".concat(O?"":"hidden")},r.a.createElement("button",{className:"change-time-button",onClick:function(){return y(O+36e5)}},"+"),r.a.createElement("button",{className:"change-time-button",onClick:function(){return y(O-36e5)}},"-")),r.a.createElement("div",{className:"central-button-flex"},r.a.createElement("button",{className:"but",onClick:function(e){u({variables:{time:O||Date.now(),type:"start"===b.type?"end":"start"}}).then(function(e){return g(Object(m.a)(Object(m.a)({},e.data.createSleep),{},{last_load:new Date}))}),e.target.blur()}},r.a.createElement("h1",null,"start"===b.type?"Acordou":"Dormiu"," "),r.a.createElement("h3",null,O?q(new Date(O)):"Agora"))),r.a.createElement("div",{className:"set-time-flex ".concat(O?"":"hidden")},r.a.createElement("button",{className:"change-time-button",onClick:function(){return y(O+6e4)}},"+"),r.a.createElement("button",{className:"change-time-button",onClick:function(){return y(O-6e4)}},"-"))),r.a.createElement("button",{className:"other-time-button",style:{cursor:"pointer"},onClick:function(e){y(O?"":Date.now())}},O?"Cancelar":"Outro hor\xe1rio?"),i===h.NetworkStatus.ready?r.a.createElement("button",{className:"update_button",style:{cursor:"pointer"},onClick:function(e){g(Object(m.a)(Object(m.a)({},b),{},{last_load:new Date})),c()}},"Atualizado as ",q(b.last_load)):r.a.createElement(x,{className:"loader"})))};console.log("here"),c.a.render(r.a.createElement(h.ApolloProvider,{client:y},r.a.createElement(P,null)),document.getElementById("root")),p(),function(e){if("serviceWorker"in navigator){if(new URL("/baby-tracker-ui",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/baby-tracker-ui","/service-worker.js");i?(function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):l(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")})):l(t,e)})}}()}},[[59,1,2]]]);
//# sourceMappingURL=main.d4b9293d.chunk.js.map